# Nano Bot V-2.0 (Local System Agent)

–õ–æ–∫–∞–ª—å–Ω—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∞–≥–µ–Ω—Ç –Ω–∞ Python 3.11+ —Å 4 –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏:
- Telegram
- System
- Browser
- Vision

–¢–∞–∫–∂–µ –≤–∫–ª—é—á–∞–µ—Ç:
- EventBus –¥–ª—è —Å–æ–±—ã—Ç–∏–π–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- CrystalMemory –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–∏–∞–ª–æ–≥–∞
- OpenRouter LLM Router (–º–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `kimi/kimi-k2.5`)
- graceful shutdown –ø–æ `SIGINT` / `SIGTERM`

## 1) –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <your-repo-url>
cd <repo-folder>
```

## 2) –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
python -m venv .venv
source .venv/bin/activate
```

–î–ª—è Windows (PowerShell):

```powershell
python -m venv .venv
.venv\Scripts\Activate.ps1
```

## 3) –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

## 4) –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±—Ä–∞—É–∑–µ—Ä–æ–≤ –¥–ª—è Playwright

```bash
python -m playwright install
```

–ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ `playwright` –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ PATH, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º–µ–Ω–Ω–æ –≤–∞—Ä–∏–∞–Ω—Ç —á–µ—Ä–µ–∑ `python -m`.

## 5) –°–æ–∑–¥–∞–Ω–∏–µ `.env` –∏–∑ `.env.example`

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä:

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- `TELEGRAM_BOT_TOKEN`
- `OPENROUTER_API_KEY`
- `OPENROUTER_MODEL`
- `LLM_CONTEXT_MAX_MESSAGES` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `40`)
- `MEMORY_MAX_MESSAGES` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `200`)
- `HANDLER_MAX_COMMAND_LENGTH` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `8000`)
- `LLM_REQUEST_TIMEOUT_SECONDS` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `45`)
- `SYSTEM_COMMAND_TIMEOUT_SECONDS` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `20`)
- `ADAPTER_START_TIMEOUT_SECONDS` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `20`)
- `ADAPTER_STOP_TIMEOUT_SECONDS` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `10`)
- `AGENT_WORKSPACE`
- `LOG_LEVEL`

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è (–ø–µ—Å–æ—á–Ω–∏—Ü–∞)

–°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∑–∞—Ä–∞–Ω–µ–µ:

- Windows:
  - `C:\Users\kopca\Nano_Bot_V2\workspace\`
- Linux/macOS (–ø—Ä–∏–º–µ—Ä):
  - `/workspace/workspace`

> –ï—Å–ª–∏ –Ω–∞ Linux/macOS –≤ `AGENT_WORKSPACE` –æ—Å—Ç–∞–≤–∏—Ç—å Windows-–ø—É—Ç—å (`C:\...`),
> –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π fallback-–ø—É—Ç—å `<repo>/workspace`.

## 6) –ó–∞–ø—É—Å–∫

```bash
python src/main.py
```

## 7) –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥—Ä–µ—Å—Å–∏–π

```bash
PYTHONPATH=src python3 -m unittest -v \
  tests/test_command_handler_shortcuts.py \
  tests/test_event_bus.py \
  tests/test_system_adapter_security.py \
  tests/test_llm_router_helpers.py
```

–¢–µ—Å—Ç—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (pytest):
```bash
pytest tests/test_notifications.py -v
```

---

## Mobile Notifications

–°–∏—Å—Ç–µ–º–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ Telegram –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∞–ª–µ—Ä—Ç–æ–≤.

### –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

| –¢–∏–ø | –ü—Ä–∏–º–µ—Ä | –ö–æ–≥–¥–∞ |
|-----|--------|-------|
| **Reminder** | üîî –ü–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ | ¬´–ù–∞–ø–æ–º–Ω–∏ —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç –ø–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ¬ª |
| **Task complete** | ‚úÖ web_search –∑–∞–≤–µ—Ä—à—ë–Ω | –£—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ |
| **Error** | üö® –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: timeout | –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–ª–∏ –æ—à–∏–±–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ |
| **System alert** | ‚ö†Ô∏è –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∏—Ç–µ—Ä–∞—Ü–∏–π | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è |

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í `~/.nanobot/config.json` –∏–ª–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```json
{
  "agents": {
    "defaults": {
      "notifications": {
        "enabled": true,
        "botToken": "YOUR_TELEGRAM_BOT_TOKEN",
        "defaultChatId": "123456789"
      }
    }
  }
}
```

–ò–ª–∏ —á–µ—Ä–µ–∑ env:
```
NANOBOT_AGENTS__DEFAULTS__NOTIFICATIONS__ENABLED=true
NANOBOT_AGENTS__DEFAULTS__NOTIFICATIONS__BOT_TOKEN=123456:ABC...
NANOBOT_AGENTS__DEFAULTS__NOTIFICATIONS__DEFAULT_CHAT_ID=123456789
```

–ï—Å–ª–∏ Telegram-–∫–∞–Ω–∞–ª —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, `botToken` –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω –∫–∞–Ω–∞–ª–∞.

### –ó–∞–ø—É—Å–∫

–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ gateway:

```bash
nanobot gateway
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º Telegram (–ø—Ä–æ–ø—É—â–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

```bash
NANOBOT_TEST_TELEGRAM=1 TELEGRAM_BOT_TOKEN=... TELEGRAM_CHAT_ID=... pytest tests/test_notifications.py::test_send_notification_real_telegram -v
```

---

## –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤ Telegram (MVP)

- –û–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç: —É—Ö–æ–¥–∏—Ç –≤ LLM
- –ö–æ–º–∞–Ω–¥—ã –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–∞–∫ slash-–∫–æ–º–∞–Ω–¥—ã (`/status`) –∏–ª–∏ –æ–±—ã—á–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º.
- `/ping` ‚Äî –±—ã—Å—Ç—Ä—ã–π health-check (`pong`)
- `/help` ‚Äî —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
- `/status` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ –∏ –ø–∞–º—è—Ç–∏ —Ç–µ–∫—É—â–µ–≥–æ —á–∞—Ç–∞
- `/clear_history` ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Ç–µ–∫—É—â–µ–≥–æ —á–∞—Ç–∞
- –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ slash-–∫–æ–º–∞–Ω–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø–æ–¥—Å–∫–∞–∑–∫—É: `–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help`
- –õ—é–±—ã–µ slash-–∫–æ–º–∞–Ω–¥—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ LLM-–∏—Å—Ç–æ—Ä–∏–∏ (—á—Ç–æ–±—ã –Ω–µ –∑–∞—Å–æ—Ä—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç)
- `/system <cmd>` ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—É—é —Å–∏—Å—Ç–µ–º–Ω—É—é –∫–æ–º–∞–Ω–¥—É (whitelist)
- `/browser_open <url>` ‚Äî –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- `/browser_text [url]` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `/screenshot <filename.png>` ‚Äî —Å–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç –≤ `AGENT_WORKSPACE/screenshots/`
- –î–ª—è `/screenshot`: –µ—Å–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `.png`
- `/ocr <image_path>` ‚Äî OCR-–∑–∞–≥–ª—É—à–∫–∞ (–ø–æ–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `OCR not implemented yet`)
- –î–ª—è `/ocr`: –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è `.png`, `.jpg`, `.jpeg`, `.webp`, `.bmp`, `.gif`

